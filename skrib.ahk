;
; AutoHotkey Version: 1.x
; Language:       English
; Platform:       Win9x/NT
; Author:         A.N.Other <myemail@nowhere.com>
;
; Script Function:
;	Template script (you can customize this template by editing "ShellNew\Template.ahk" in your Windows folder)
;

#NoEnv  ; Recommended for performance and compatibility with future AutoHotkey releases.
SendMode Input  ; Recommended for new scripts due to its superior speed and reliability.
SetWorkingDir %A_ScriptDir%  ; Ensures a consistent starting directory.
#Persistent
CoordMode, Mouse, Screen

^1::
ArrayX := []
ArrayY := []
n = 0
i = 0
oldx = null
oldy = null
continue = True
Goto, Record


!*::
Record:
loop,
{
	if continue = False
		break
	else
	{		
		MouseGetPos, x
		MouseGetPos,, y
		if (x != oldx) || (y != oldy)
		{
			oldx := x
			oldy := y
			ArrayX.InsertAt(n, x)
			ArrayY.InsertAt(n, y)
			Sleep 50
			n++
		}		
	}	
}
return

;!º::
;Record:
;loop,
;{
	;if continue = False
		;break
	;else
	;{		
		;MouseGetPos, x
		;MouseGetPos,, y
		;PixelGetColor, color1, x, y
		;PixelGetColor, color2, x+2, y+2
		;PixelGetColor, color3, x+2, y-2
		;PixelGetColor, color4, x-2, y+2
		;PixelGetColor, color5, x-2, y-2
		;if (color1 = 0xFFFFFF) && (color2 = 0xFFFFFF) && (color3 = 0xFFFFFF) && (color4 = 0xFFFFFF) && (color5 = 0xFFFFFF)
		;{
			;PixelGetColor, xpredict, oldx, y
			;if xpredict = 0x000000
			;{
				;MouseMove, %oldx%, %y%
				;ArrayX.InsertAt(n, oldx)
				;ArrayY.InsertAt(n, y)
				;Sleep 50
				;n++
				;oldx = %x%
				;oldy = %y%
			;}
			;else
			;{
				;PixelGetColor, ypredict, x, oldy
				;if ypredict = 0x000000
				;{
					;{
						;MouseMove, %x%, %oldy%
						;ArrayX.InsertAt(n, x)
						;ArrayY.InsertAt(n, oldy)
						;Sleep 50
						;n++
						;oldx = %x%
						;oldy = %y%
					;}
				;}
				;else
				;{
					;MouseMove, %oldx%, %oldy%
				;}
			;}
		;}
		;else
		;{
			;ArrayX.InsertAt(n, x)
			;ArrayY.InsertAt(n, y)
			;Sleep 50
			;n++
			;oldx = %x%
			;oldy = %y%
		;}
	;}	
;}
;return

2::
if continue = True
{
	ArrayX.InsertAt(n, "skip")
	ArrayY.InsertAt(n, "skip")
	n++
	continue = False
}
else if continue = False
{
	continue = True
	Send !*
}
return

^3::
continue = False
loop, %n%
{
	if (ArrayY[i] = "skip") || (ArrayY[i] = "skip") || (ArrayY[i-1] = "skip") || (ArrayY[i-1] = "skip")
	{
		Send {lbutton up}
		i++
	}
	else
	{
		;MouseClickDrag, Left, ArrayX[i], ArrayY[i], ArrayX[i+1], ArrayY[i+1]
		MouseMove, ArrayX[i], ArrayY[i]
		Send {lbutton down}
		i++
	}
}
Send {lbutton up}
i = 0
return


^4::
csvX := ""
csvY := ""
for index, element in ArrayX
{
	
	csvX .= "" ArrayX[index] ","
	csvY .= "" ArrayY[index] ","
}

MsgBox, %csvX%  
MsgBox, %csvY% 
return

^6::

Count := Object.Count()
SavedArrayX1 = skip, 1039,1040,1041,1044,1046,1047,1051,1053,1054,1056,1057,1060,1061,1063,1064,1065,1066,1066,1068,1069,1070,1071,1072,1073,1075,1076,1078,1079,1079,1079,1080,1081,1081,1082,1082,1082,1083,1083,1083,1083,1083,1083,1082,1082,1082,1082,1082,1082,1082,1082,1082,1082,1082,1082,1081,1080,1078,1078,1077,1077,1077,1076,1075,1074,1073,1071,1070,1070,1069,1068,1068,1067,1067,1065,1064,1063,1062,1062,1062,1062,1062,1061,1061,1060,1060,1060,1060,1060,1060,1060,1060,1060,1061,1062,1062,1063,1063,1065,1067,1069,1071,1071,1072,1073,1073,1075,1077,1080,1082,1083,1083,1084,1085,1087,1089,1090,1091,1091,1091,1091,1091,1092,1092,1093,1094,1094,1094,1094,1094,1094,1094,1094,1094,1094,1094,1094,1094,1094,1093,1093,1092,1091,1090,1090,1089,1088,1087,1087,1086,1086,1085,1084,1082,1080,1078,1076,1076,1075,1075,1074,1074,1073,1072,1071,1070,1068,1066,1065,1063,1063,1062,1060,1057,1054,1049,1043,1039,1038,1037,1036,1033,1032,1030,1026,1023,1020,1020,1015,1009,1005,1003,1002,1001,996,993,990,989,988,986,983,982,980,978,975,972,969,968,966,964,962,961,959,958,956,955,953,952,951,950,949,947,946,945,944,943,942,940,938,937,936,936,935,935,934,933,933,933,932,932,932,932,932,932,933,934,935,936,937,938,939,940,941,942,943,944,946,947,949,950,952,953,955,956,957,958,960,962,963,964,963,959,956,953,950,948,946,944,942,941,940,939,937,936,934,933,933,931,930,930,929,929,929,929,929,929,928,928,928,928,928,928,928,928,928,928,928,928,928,929,929,930,931,932,933,skip,930,929,928,927,926,924,923,922,920,919,917,917,915,914,912,911,910,910,909,908,907,907,907,907,907,908,908,908,909,909,909,910,911,911,911,912,913,915,916,917,919,919,920,921,922,923,925,926,927,928,929,930,932,933,934,935,936,937,937,938,939,940,941,942,942,943,944,945,946,946,948,950,952,953,953,954,955,955,955,956,956,957,958,959,958,957,956,955,954,953,952,950,948,947,946,945,944,943,942,941,940,939,938,937,936,936,935,934,933,933,932,932,932,931,931,skip,958,959,960,961,961,961,962,963,963,964,965,965,966,967,967,968,968,969,969,970,970,970,970,970,970,970,971,971,971,971,971,972,972,972,972,972,972,972,972,972,971,971,971,970,969,969,968,967,967,966,966,965,965,964,963,962,962,961,961,960,959,958,957,957,956,955,954,953,953,953,952,952,951,951,950,949,948,946,946,945,945,945,944,943,942,942,941,940,939,938,937,937,937,937,937,936,936,936,936,936,936,936,936,937,937,938,938,939,939,940,941,942,942,942,943,943,943,943,944,944,945,945,945,945,946,946,946,946,946,946,946,945,945,945,945,944,944,944,944,944,944,944,943,942,942,940,940,938,937,935,935,934,933,930,927,925,924,923,921,919,916,912,909,908,907,905,903,901,899,897,895,893,892,890,889,888,886,883,879,877,876,876,875,875,874,873,873,872,872,870,870,869,869,869,869,869,869,869,869,870,870,871,872,874,874,875,876,878,879,880,883,886,888,890,891,893,894,896,897,899,901,902,904,905,907,909,910,912,913,915,917,918,919,920,920,921,920,919,918,917,916,915,915,914,913,912,910,909,908,907,906,906,905,904,903,903,902,902,901,901,901,900,900,900,900,900,900,900,900,901,902,903,904,905,906,907,908,910,912,914,916,917,919,920,921,923,925,929,933,934,937,939,941,944,947,950,954,958,961,964,967,970,971,974,976,977,978,979,981,983,986,989,991,994,997,1001,1004,1006,1009,1011,1014,1016,1017,1019,1021,1024,1026,1027,1030,1035,1037,1037,1038,1039,1040,1042,1043,1045,1046,1048,1050,1051,1052,1053,1053,1054,1054,1056,1056,1057,1058,1058,1059,1059,1059,1059,1060,1060,1060,1060,1060,1060,1060,1060,1060,1060,1060,1060,1059,1059,1059,1058,1057,1056,1055,1055,1053,1053,1052,1052,1052,skip,1046,1046,1046,1046,1046,1046,1045,1045,1045,1045,1045,1045,1045,1045,1045,1045,1045,1045,1045,1046,1047,1047,1048,1049,1049,1050,1051,1051,1052,1052,1053,1055,1056,1057,1057,1057,1058,1058,1058,1058,1058,1059,1059,1059,1059,1060,1060,skip,967,968,969,971,972,974,975,976,978,981,984,988,991,992,995,996,998,1001,1003,1006,1008,1010,1012,1013,1014,1015,1017,1019,1021,1022,1024,1026,1028,1029,1031,1031,1032,1034,1035,1036,1038,1039,1041,1044,1045,1047,1048,1050,1050,1053,1054,1055,1056,1058,1059,1060,1061,1063,1064,1065,1067,1068,1069,1070,1071,1072,1073,1074,1075,1076,1078,1079,1079,1079,1080,1080,1081,1081,1082,1082,1082,1082,skip,1033,1033,1033,1035,1036,1037,1039,1040,1042,1043,1045,1046,1047,1048,1050,1051,1053,1055,1056,1057,1058,1059,1059,1060,1060,1061,1062,1063,1064,1064,1065,1065,1066,1066,1066,1067,1067,1067,skip,881,881,881,881,881,881,881,881,881,882,882,883,884,885,886,886,887,888,889,890,890,892,893,894,896,897,899,901,903,906,909,912,913,916,920,923,927,930,933,937,943,946,947,948,949,950,skip,969,969,970,972,974,976,976,978,980,981,982,983,984,985,985,985,986,987,987,987,987,987,987,987,987,987,987,987,987,987,986,985,985,984,984,984,983,982,980,979,978,977,976,975,974,973,971,970,968,966,964,963,961,958,957,956,955,954,952,951,950,949,949,948,947,946,945,944,944,943,943,942,942,941,941,941,940,940,940,940,939,939,939,skip,967,967,969,973,976,978,980,982,984,986,988,990,992,994,997,999,1002,1003,1005,1006,1007,1009,1010,1013,1015,1016,1017,1017,1019,1019,1019,1019,1019,1019,1018,1017,1016,1016,1015,1015,1014,1013,1013,1012,1012,1012,1011,1011,1010,1009,1008,1008,1008,1006,1005,1004,1003,1002,1001,1000,998,997,996,995,994,993,992,991,990,990,990,989,988,988,988,987,986,986,985,985,985,985,984,984,984,985,985,986,987,989,990,991,992,992,993,995,998,999,1000,1001,1001,1002,1003,1004,skip,922,922,920,920,919,918,918,917,917,917,916,916,915,915,914,914,913,913,913,913,913,913,914,915,915,916,918,918,920,922,925,926,928,929,931,933,935,936,937,938,939,938,937,936,934,933,932,931,929,927,924,921,919,918,917,916,915,914,912,911,910,909,909,908,908,907,907,907,907,906,906,906,906,906,906,906,906,906,907,907,907,908,908,skip,972,972,972,972,972,972,973,973,973,974,975,975,976,976,977,977,978,979,979,980,981,982,982,982,983,983,983,983,983,984,984,984,984,984,983,983,983,982,982,982,982,981,981,981,980,980,980,979,979,979,979,978,978,977,977,977,976,975,975,974,973,972,971,970,968,967,967,966,965,963,962,961,960,959,958,957,skip,1003,1003,1003,1003,1001,1000,999,997,997,996,996,995,995,994,993,992,992,991,991,990,989,988,987,986,984,982,981,981,979,976,975,973,972,970,969,968,967,skip,1056,1056,1056,1055,1054,1054,1053,1053,1052,1052,1052,1052,1052,1052,1051,1051,1050,1049,1048,1048,1047,1046,1045,1044,1044,1043,1042,1041,1040,1038,1036,1035,1033,1031,1030,1028,1026,1023,1020,1015,1013,1012,1010,1006,1000,996,993,990,985,981,978,974,969,965,963,961,959,957,956,955,955,skip,1064,1064,1065,1065,1065,1065,1066,1066,1067,1067,1067,1067,1068,1068,1069,1069,1070,1070,1070,1071,1071,1072,1072,1072,1072,1073,1074,1074,1075,1076,1077,1077,1078,1078,1078,1078,1078,1078,1078,1078,1078,1077,1077,1077,1076,1076,1075,1075,1075,1074,1074,1074,1074,1074,1073,1073,1073,1073,1073,1073,1073,1072,1072,1071,1071,1070,1070,1069,1069,1068,1068,1068,1068,1067,1067,1067,1067,1066,1066,1065,1065,1064,1063,1063,1062,1061,1061,1061,1060,1059,1058,1058,1057,1055,1054,1052,1051,1050,1049,1047,1045,1043,1042,1040,1038,1037,1036,1035,1032,1031,1029,1028,1025,1022,1019,1017,1013,1010,1007,1004,1002,999,996,993,989,986,983,980,977,973,971,970,969,967,964,962,961,960,958,956,954,953,952,952,951,950,949,948,948,947,947,945,944,skip,991,992,993,994,995,996,997,998,999,1001,1003,1005,1006,1008,1011,1013,1015,1016,1017,1018,1020,1021,1022,1023,1024,1026,1029,1030,1032,1034,1035,1037,1038,1040,1041,1042,1043,1045,1046,1048,1048,1049,1049,1050,1051,1051,1052,1052,1053,1053,1053,1053,1054 ;,1051,1036,1023,1017,1009,1000,1000,1001,1002,1002 ;980,930,861,797,759,731,700,662,616,568,537,498,473,462,452,439,423,407,388,366,357,356,355,349,346,346,354,369,
SavedArrayY1 = skip, 815,815,815,816,817,817,819,819,819,819,819,817,817,815,814,813,811,810,808,806,804,802,800,797,794,790,787,784,783,782,779,776,773,772,769,766,761,755,753,752,749,745,742,738,731,726,723,720,718,713,706,700,697,695,691,685,678,675,673,672,669,666,661,655,651,647,643,639,634,628,622,618,616,612,606,600,597,596,595,592,587,582,577,573,571,569,564,558,555,554,552,548,542,535,530,527,525,520,514,507,501,499,498,495,492,488,482,475,471,468,467,465,462,453,446,441,440,439,438,436,434,432,428,421,416,413,412,410,408,405,400,395,391,390,389,388,385,384,381,375,369,365,364,362,360,358,356,355,353,352,351,348,345,340,334,331,330,330,328,327,326,325,323,321,317,314,311,307,304,303,300,297,293,287,280,273,269,268,268,266,265,264,263,261,259,258,257,256,254,253,253,253,253,253,252,252,252,252,252,253,253,254,255,257,258,259,260,261,262,263,263,264,265,266,267,268,268,269,269,270,271,271,272,272,273,273,274,275,276,276,277,277,278,279,280,281,282,283,284,283,282,280,279,277,275,274,272,270,268,266,265,262,261,259,257,255,254,252,251,250,249,248,248,247,247,246,245,245,245,245,246,247,248,249,249,250,251,252,252,253,254,255,256,257,258,259,260,261,262,263,264,265,266,267,268,268,269,270,271,272,273,274,276,277,278,279,280,281,282,283,284,285,286,288,skip,288,288,288,289,290,290,291,292,292,293,293,294,295,295,295,296,296,297,297,297,298,299,300,301,302,303,305,306,308,310,311,312,314,316,317,318,320,323,325,326,328,329,330,330,331,333,334,335,336,337,338,339,340,341,341,342,343,343,344,344,344,344,344,344,343,342,341,340,339,338,337,335,333,333,332,331,331,330,329,329,328,328,326,326,326,326,325,324,323,322,321,319,318,316,314,313,311,310,308,307,305,303,302,300,299,298,297,295,294,293,292,290,289,289,288,skip,326,326,326,326,327,328,328,329,331,332,333,335,336,337,339,341,344,346,349,351,354,356,359,361,364,367,370,372,374,376,380,383,386,390,393,395,398,401,406,408,411,413,416,419,424,428,432,436,439,442,445,448,449,452,455,459,461,463,465,468,472,477,480,482,485,489,494,498,500,501,503,505,506,508,510,512,516,520,522,523,524,525,526,529,531,533,534,537,541,545,546,547,549,551,554,555,556,557,558,560,563,567,569,574,578,581,582,585,588,592,595,598,599,602,605,608,609,611,616,622,626,628,629,633,638,641,643,644,646,648,651,654,657,659,662,664,667,671,674,678,682,687,690,692,693,695,696,700,704,709,710,711,713,717,723,726,727,727,728,731,734,739,743,745,745,747,749,751,753,754,756,757,758,760,761,762,764,768,776,780,781,782,782,783,784,786,787,789,791,795,797,799,801,804,806,808,810,813,815,820,823,827,833,839,841,841,843,845,847,849,852,855,857,858,859,860,861,862,863,864,865,865,866,866,866,866,866,866,866,866,866,866,866,866,865,865,865,864,864,863,862,862,861,860,859,857,856,855,853,852,851,850,849,847,845,844,842,840,839,837,833,833,831,830,828,826,824,822,821,819,817,815,813,812,810,808,807,805,803,800,798,797,795,794,793,792,791,789,788,787,786,786,785,784,782,781,780,779,778,777,776,775,774,773,772,771,771,771,770,769,768,767,766,765,764,763,761,761,759,758,756,755,754,753,751,749,747,746,743,739,737,736,735,734,732,731,729,727,725,723,720,717,715,715,713,710,708,703,700,697,694,691,687,685,682,680,675,672,670,668,665,661,657,655,649,644,641,640,637,636,634,631,629,627,625,624,621,620,619,618,617,skip,640,639,638,636,634,633,632,631,629,627,625,623,621,618,616,613,610,609,605,602,599,597,596,592,591,587,585,582,580,577,574,569,565,564,563,562,561,560,559,558,557,555,554,553,552,551,550,skip,779,780,781,782,782,783,783,784,785,786,787,788,788,788,788,788,788,788,788,788,788,788,788,788,788,788,788,788,788,788,788,787,787,787,787,786,786,786,786,786,785,785,784,783,782,782,781,780,779,777,776,775,774,772,771,770,769,767,766,765,763,761,759,757,756,754,753,751,750,747,743,742,740,739,738,736,733,732,731,730,729,728,skip,805,804,803,802,801,799,798,797,795,794,792,791,790,789,787,785,784,782,781,779,778,778,777,776,774,772,770,769,768,767,766,765,764,763,762,762,760,759,skip,849,848,847,846,845,843,842,840,839,838,836,835,832,831,829,827,825,823,821,820,818,816,814,811,809,808,804,802,800,798,795,793,792,791,789,788,787,786,785,784,782,781,781,780,779,779,skip,744,743,743,741,738,737,735,733,730,728,726,724,722,720,717,716,715,712,711,710,708,705,703,700,696,694,692,689,685,682,679,676,673,671,670,668,665,661,658,654,651,649,646,643,640,637,634,630,625,620,617,614,611,607,604,601,599,597,594,591,589,587,586,583,581,579,577,575,574,571,570,568,566,564,563,562,561,560,558,557,555,554,553,skip,765,764,763,760,758,755,753,749,748,745,742,740,736,733,730,727,724,722,718,717,714,711,709,706,701,698,696,693,688,684,680,678,676,672,667,661,658,656,653,649,646,642,638,635,632,630,628,625,620,615,612,611,609,606,601,597,594,592,590,586,581,578,575,573,570,567,562,558,555,554,552,549,545,544,542,539,534,529,525,520,518,516,515,510,503,497,492,489,483,476,471,469,466,464,461,457,450,446,444,442,440,440,437,435,skip,795,796,798,799,801,803,805,807,809,810,812,813,815,817,818,820,822,824,826,827,829,830,831,833,834,834,836,837,837,838,838,838,838,838,838,838,838,838,838,837,837,837,838,839,840,841,841,842,842,842,842,842,842,841,841,841,840,840,840,839,838,838,837,836,834,832,831,830,829,827,826,824,823,821,818,817,815,813,812,811,810,810,809,skip,424,423,422,420,418,417,414,413,411,409,408,406,403,402,401,399,397,395,393,389,386,383,381,379,377,375,373,370,368,366,363,360,357,355,354,352,351,349,346,345,344,342,341,340,338,336,335,334,333,332,331,330,329,328,327,326,325,324,323,322,321,320,319,318,317,317,316,316,316,316,316,316,317,318,318,318,skip,365,364,363,362,359,356,354,351,348,346,344,343,341,339,337,334,331,330,329,327,326,323,321,320,317,316,315,314,313,313,313,313,313,313,313,314,314,skip,395,394,391,387,383,379,376,373,370,367,364,362,360,357,354,351,348,345,340,334,332,329,324,321,319,317,314,312,310,308,305,303,301,300,298,297,295,293,291,289,289,288,288,288,287,287,287,287,287,287,288,290,292,294,295,297,298,300,300,301,302,skip,511,510,508,507,505,502,499,496,494,491,488,485,481,478,475,471,467,464,461,456,453,451,446,444,442,439,435,432,428,424,421,417,413,410,408,405,400,397,394,391,388,386,384,381,378,374,371,368,366,364,361,359,357,355,353,351,348,347,344,342,341,339,337,335,332,330,328,326,325,324,323,322,321,320,319,318,317,316,314,314,312,311,309,307,305,304,303,302,301,300,298,297,296,294,292,291,290,288,287,286,284,282,281,279,278,277,277,276,275,273,273,272,271,269,268,267,267,266,266,265,265,265,265,265,266,267,268,269,271,273,274,274,276,277,280,282,282,283,285,287,288,290,290,291,291,292,293,294,295,295,296,298,299,skip,774,774,774,773,773,773,773,772,772,772,771,771,770,770,769,768,767,766,766,765,764,764,763,762,761,760,758,757,755,754,752,751,750,748,747,746,744,742,739,737,736,734,732,730,728,727,725,723,722,721,720,719,718,717,715,719,733,739,747,746,743,740,739,734,722,707,703,701,697,695,692,688,684,679,672,667,663,662,663,661,644,620,596,588,587,581,562,557,558,563,572,

ArrayX := StrSplit(SavedArrayX1, ",")
ArrayY := StrSplit(SavedArrayY1, ",")


nSaved = % ArrayX.Count()
nSaved2 = % ArrayX.Count()
n := nSaved + 1
i = 0
MsgBox %nSaved% %nSaved2% %n%
MsgBox % String := ArrayX[1]
return

^7::
IniRead, ArrayX, skrib/savedimages.ini, test, testX
IniRead, ArrayY, skrib/savedimages.ini, test, testY
MsgBox %ArrayX%
return

continue = False
loop, %nSaved%
{
	if (SavedArrayY1[i] = skip) || (SavedArrayY1[i-1] = skip)
	{
		Send {lbutton up}
		i++
	}
	else
	{
		;MouseClickDrag, Left, ArrayX[i], ArrayY[i], ArrayX[i+1], ArrayY[i+1]
		MouseMove, SavedArrayX1[i], SavedArrayY1[i]
		Send {lbutton down}
		i++
	}
}
Send {lbutton up}
i = 0
return

esc::Reload